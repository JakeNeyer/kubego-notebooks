import { Injectable } from '@angular/core';
import { parse } from 'date-fns';
import { isEqual } from 'date-fns';
import { setHours } from 'date-fns';
import { setMinutes } from 'date-fns';
import { setSeconds } from 'date-fns';
import { distanceInWords } from 'date-fns';
import { differenceInSeconds } from 'date-fns';
import memoize from 'lodash-es/memoize';
import * as i0 from "@angular/core";
export const defaultDateOptions = {
    weekday: 'short',
    year: 'numeric',
    month: 'short',
    day: 'numeric',
};
export const defaultTimeOptions = {
    hour: 'numeric',
    minute: 'numeric',
    second: 'numeric',
    hour12: false,
};
const intlOptions = Object.assign({}, defaultDateOptions, defaultTimeOptions);
function dateTimeFormat(obj) {
    return new Intl.DateTimeFormat(obj.locale, obj.options).format(obj.date);
}
const memoizedDateTimeFormat = memoize(dateTimeFormat);
export class DateTimeService {
    constructor() { }
    parse(date) {
        // https://date-fns.org/v1.29.0/docs/parse
        return parse(date);
    }
    isEqual(date1, date2) {
        // This helper should be used whenever testing if two date objects
        // represent the same point in time is required. Note that equality
        // operators perform an identity check on Date objects, and thus do not
        // work as expected.
        return isEqual(date1, date2);
    }
    intlFormat(date, options, locale) {
        if (date == null) {
            return '-';
        }
        if (typeof date === 'string') {
            date = new Date(date);
        }
        if (!options) {
            options = intlOptions;
        }
        if (!locale) {
            locale = navigator.language || 'en-US';
        }
        return memoizedDateTimeFormat({ locale, options, date });
    }
    merge(date, time) {
        // FIXME: Return an invalid date object or raise an error if the input
        // is invalid.
        let dateTime = parse(date);
        const timeArr = time.split(':');
        let hours = parseInt(timeArr[0], 10);
        let minutes = parseInt(timeArr[1], 10);
        let seconds = parseInt(timeArr[2], 10);
        if (this.isNotValidNumber(hours) || !this.isValidHours(hours)) {
            hours = 0;
        }
        if (this.isNotValidNumber(minutes) || !this.isValidMinutes(minutes)) {
            minutes = 0;
        }
        if (this.isNotValidNumber(seconds) || !this.isValidSeconds(seconds)) {
            seconds = 0;
        }
        dateTime = setHours(dateTime, hours);
        dateTime = setMinutes(dateTime, minutes);
        dateTime = setSeconds(dateTime, seconds);
        return dateTime;
    }
    distanceInWords(dateToCompare, date = new Date()) {
        return distanceInWords(date, dateToCompare, {
            includeSeconds: false,
            addSuffix: true,
        })
            .replace('about', '')
            .replace('almost', '');
    }
    isNotValidNumber(unit) {
        return Number.isNaN(unit);
    }
    isValidHours(hours) {
        return this.between(hours, 0, 24);
    }
    isValidMinutes(minutes) {
        return this.between(minutes, 0, 60);
    }
    isValidSeconds(seconds) {
        return this.between(seconds, 0, 60);
    }
    between(x, min, max) {
        return x >= min && x <= max;
    }
    differenceInSeconds(d1, d2) {
        return differenceInSeconds(d1, d2);
    }
}
DateTimeService.ɵfac = function DateTimeService_Factory(t) { return new (t || DateTimeService)(); };
DateTimeService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: DateTimeService, factory: DateTimeService.ɵfac, providedIn: 'root' });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(DateTimeService, [{
        type: Injectable,
        args: [{ providedIn: 'root' }]
    }], function () { return []; }, null); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZS10aW1lLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9rdWJlZmxvdy9zcmMvbGliL3NlcnZpY2VzL2RhdGUtdGltZS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUNqQyxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBQ25DLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFDcEMsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUN0QyxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFDM0MsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sVUFBVSxDQUFDO0FBQy9DLE9BQU8sT0FBTyxNQUFNLG1CQUFtQixDQUFDOztBQUV4QyxNQUFNLENBQUMsTUFBTSxrQkFBa0IsR0FBK0I7SUFDNUQsT0FBTyxFQUFFLE9BQU87SUFDaEIsSUFBSSxFQUFFLFNBQVM7SUFDZixLQUFLLEVBQUUsT0FBTztJQUNkLEdBQUcsRUFBRSxTQUFTO0NBQ2YsQ0FBQztBQUNGLE1BQU0sQ0FBQyxNQUFNLGtCQUFrQixHQUErQjtJQUM1RCxJQUFJLEVBQUUsU0FBUztJQUNmLE1BQU0sRUFBRSxTQUFTO0lBQ2pCLE1BQU0sRUFBRSxTQUFTO0lBQ2pCLE1BQU0sRUFBRSxLQUFLO0NBQ2QsQ0FBQztBQUNGLE1BQU0sV0FBVyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLGtCQUFrQixFQUFFLGtCQUFrQixDQUFDLENBQUM7QUFFOUUsU0FBUyxjQUFjLENBQUMsR0FJdkI7SUFDQyxPQUFPLElB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QUUsYUFBYSxFQUFFO1lBQzFDLGNBQWMsRUFBRSxLQUFLO1lBQ3JCLFNBQVMsRUFBRSxJQUFJO1NBQ2hCLENBQUM7YUFDQyxPQUFPLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQzthQUNwQixPQUFPLENBQUMsUUFBUSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQzNCLENBQUM7SUFFTyxnQkFBZ0IsQ0FBQyxJQUFZO1FBQ25DLE9BQU8sTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUM1QixDQUFDO0lBRU8sWUFBWSxDQUFDLEtBQWE7UUFDaEMsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDcEMsQ0FBQztJQUVPLGNBQWMsQ0FBQyxPQUFlO1FBQ3BDLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQ3RDLENBQUM7SUFFTyxjQUFjLENBQUMsT0FBZTtRQUNwQyxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUN0QyxDQUFDO0lBRU8sT0FBTyxDQUFDLENBQVMsRUFBRSxHQUFXLEVBQUUsR0FBVztRQUNqRCxPQUFPLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQztJQUM5QixDQUFDO0lBRUQsbUJBQW1CLENBQUMsRUFBUSxFQUFFLEVBQVE7UUFDcEMsT0FBTyxtQkFBbUIsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDckMsQ0FBQzs7OEVBN0ZVLGVBQWU7cUVBQWYsZUFBZSxXQUFmLGVBQWUsbUJBREYsTUFBTTt1RkFDbkIsZUFBZTtjQUQzQixVQUFVO2VBQUMsRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgcGFyc2UgfSBmcm9tICdkYXRlLWZucyc7XG5pbXBvcnQgeyBpc0VxdWFsIH0gZnJvbSAnZGF0ZS1mbnMnO1xuaW1wb3J0IHsgc2V0SG91cnMgfSBmcm9tICdkYXRlLWZucyc7XG5pbXBvcnQgeyBzZXRNaW51dGVzIH0gZnJvbSAnZGF0ZS1mbnMnO1xuaW1wb3J0IHsgc2V0U2Vjb25kcyB9IGZyb20gJ2RhdGUtZm5zJztcbmltcG9ydCB7IGRpc3RhbmNlSW5Xb3JkcyB9IGZyb20gJ2RhdGUtZm5zJztcbmltcG9ydCB7IGRpZmZlcmVuY2VJblNlY29uZHMgfSBmcm9tICdkYXRlLWZucyc7XG5pbXBvcnQgbWVtb2l6ZSBmcm9tICdsb2Rhc2gtZXMvbWVtb2l6ZSc7XG5cbmV4cG9ydCBjb25zdCBkZWZhdWx0RGF0ZU9wdGlvbnM6IEludGwuRGF0ZVRpbWVGb3JtYXRPcHRpb25zID0ge1xuICB3ZWVrZGF5OiAnc2hvcnQnLFxuICB5ZWFyOiAnbnVtZXJpYycsXG4gIG1vbnRoOiAnc2hvcnQnLFxuICBkYXk6ICdudW1lcmljJyxcbn07XG5leHBvcnQgY29uc3QgZGVmYXVsdFRpbWVPcHRpb25zOiBJbnRsLkRhdGVUaW1lRm9ybWF0T3B0aW9ucyA9IHtcbiAgaG91cjogJ251bWVyaWMnLFxuICBtaW51dGU6ICdudW1lcmljJyxcbiAgc2Vjb25kOiAnbnVtZXJpYycsXG4gIGhvdXIxMjogZmFsc2UsXG59O1xuY29uc3QgaW50bE9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0RGF0ZU9wdGlvbnMsIGRlZmF1bHRUaW1lT3B0aW9ucyk7XG5cbmZ1bmN0aW9uIGRhdGVUaW1lRm9ybWF0KG9iajoge1xuICBkYXRlOiBEYXRlIHwgbnVtYmVyO1xuICBvcHRpb25zPzogSW50bC5EYXRlVGltZUZvcm1hdE9wdGlvbnM7XG4gIGxvY2FsZT86IHN0cmluZztcbn0pIHtcbiAgcmV0dXJuIG5ldyBJbnRsLkRhdGVUaW1lRm9ybWF0KG9iai5sb2NhbGUsIG9iai5vcHRpb25zKS5mb3JtYXQob2JqLmRhdGUpO1xufVxuXG5jb25zdCBtZW1vaXplZERhdGVUaW1lRm9ybWF0ID0gbWVtb2l6ZShkYXRlVGltZUZvcm1hdCk7XG5cbkBJbmplY3RhYmxlKHsgcHJvdmlkZWRJbjogJ3Jvb3QnIH0pXG5leHBvcnQgY2xhc3MgRGF0ZVRpbWVTZXJ2aWNlIHtcbiAgY29uc3RydWN0b3IoKSB7fVxuXG4gIHB1YmxpYyBwYXJzZShkYXRlOiBzdHJpbmcgfCBudW1iZXIgfCBEYXRlKTogRGF0ZSB7XG4gICAgLy8gaHR0cHM6Ly9kYXRlLWZucy5vcmcvdjEuMjkuMC9kb2NzL3BhcnNlXG4gICAgcmV0dXJuIHBhcnNlKGRhdGUpO1xuICB9XG5cbiAgcHVibGljIGlzRXF1YWwoZGF0ZTE6IERhdGUsIGRhdGUyOiBEYXRlKTogYm9vbGVhbiB7XG4gICAgLy8gVGhpcyBoZWxwZXIgc2hvdWxkIGJlIHVzZWQgd2hlbmV2ZXIgdGVzdGluZyBpZiB0d28gZGF0ZSBvYmplY3RzXG4gICAgLy8gcmVwcmVzZW50IHRoZSBzYW1lIHBvaW50IGluIHRpbWUgaXMgcmVxdWlyZWQuIE5vdGUgdGhhdCBlcXVhbGl0eVxuICAgIC8vIG9wZXJhdG9ycyBwZXJmb3JtIGFuIGlkZW50aXR5IGNoZWNrIG9uIERhdGUgb2JqZWN0cywgYW5kIHRodXMgZG8gbm90XG4gICAgLy8gd29yayBhcyBleHBlY3RlZC5cbiAgICByZXR1cm4gaXNFcXVhbChkYXRlMSwgZGF0ZTIpO1xuICB9XG5cbiAgcHVibGljIGludGxGb3JtYXQoXG4gICAgZGF0ZTogRGF0ZSB8IG51bWJlciB8IHN0cmluZyxcbiAgICBvcHRpb25zPzogSW50bC5EYXRlVGltZUZvcm1hdE9wdGlvbnMsXG4gICAgbG9jYWxlPzogc3RyaW5nLFxuICApOiBzdHJpbmcge1xuICAgIGlmIChkYXRlID09IG51bGwpIHtcbiAgICAgIHJldHVybiAnLSc7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZGF0ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGRhdGUgPSBuZXcgRGF0ZShkYXRlKTtcbiAgICB9XG4gICAgaWYgKCFvcHRpb25zKSB7XG4gICAgICBvcHRpb25zID0gaW50bE9wdGlvbnM7XG4gICAgfVxuICAgIGlmICghbG9jYWxlKSB7XG4gICAgICBsb2NhbGUgPSBuYXZpZ2F0b3IubGFuZ3VhZ2UgfHwgJ2VuLVVTJztcbiAgICB9XG4gICAgcmV0dXJuIG1lbW9pemVkRGF0ZVRpbWVGb3JtYXQoeyBsb2NhbGUsIG9wdGlvbnMsIGRhdGUgfSk7XG4gIH1cblxuICBwdWJsaWMgbWVyZ2UoZGF0ZTogc3RyaW5nIHwgRGF0ZSwgdGltZTogc3RyaW5nKTogRGF0ZSB7XG4gICAgLy8gRklYTUU6IFJldHVybiBhbiBpbnZhbGlkIGRhdGUgb2JqZWN0IG9yIHJhaXNlIGFuIGVycm9yIGlmIHRoZSBpbnB1dFxuICAgIC8vIGlzIGludmFsaWQuXG4gICAgbGV0IGRhdGVUaW1lOiBEYXRlID0gcGFyc2UoZGF0ZSk7XG4gICAgY29uc3QgdGltZUFyciA9IHRpbWUuc3BsaXQoJzonKTtcbiAgICBsZXQgaG91cnMgPSBwYXJzZUludCh0aW1lQXJyWzBdLCAxMCk7XG4gICAgbGV0IG1pbnV0ZXMgPSBwYXJzZUludCh0aW1lQXJyWzFdLCAxMCk7XG4gICAgbGV0IHNlY29uZHMgPSBwYXJzZUludCh0aW1lQXJyWzJdLCAxMCk7XG4gICAgaWYgKHRoaXMuaXNOb3RWYWxpZE51bWJlcihob3VycykgfHwgIXRoaXMuaXNWYWxpZEhvdXJzKGhvdXJzKSkge1xuICAgICAgaG91cnMgPSAwO1xuICAgIH1cbiAgICBpZiAodGhpcy5pc05vdFZhbGlkTnVtYmVyKG1pbnV0ZXMpIHx8ICF0aGlzLmlzVmFsaWRNaW51dGVzKG1pbnV0ZXMpKSB7XG4gICAgICBtaW51dGVzID0gMDtcbiAgICB9XG4gICAgaWYgKHRoaXMuaXNOb3RWYWxpZE51bWJlcihzZWNvbmRzKSB8fCAhdGhpcy5pc1ZhbGlkU2Vjb25kcyhzZWNvbmRzKSkge1xuICAgICAgc2Vjb25kcyA9IDA7XG4gICAgfVxuICAgIGRhdGVUaW1lID0gc2V0SG91cnMoZGF0ZVRpbWUsIGhvdXJzKTtcbiAgICBkYXRlVGltZSA9IHNldE1pbnV0ZXMoZGF0ZVRpbWUsIG1pbnV0ZXMpO1xuICAgIGRhdGVUaW1lID0gc2V0U2Vjb25kcyhkYXRlVGltZSwgc2Vjb25kcyk7XG4gICAgcmV0dXJuIGRhdGVUaW1lO1xuICB9XG5cbiAgZGlzdGFuY2VJbldvcmRzKFxuICAgIGRhdGVUb0NvbXBhcmU6IHN0cmluZyB8IERhdGUsXG4gICAgZGF0ZTogc3RyaW5nIHwgRGF0ZSA9IG5ldyBEYXRlKCksXG4gICk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGRpc3RhbmNlSW5Xb3JkcyhkYXRlLCBkYXRlVG9Db21wYXJlLCB7XG4gICAgICBpbmNsdWRlU2Vjb25kczogZmFsc2UsXG4gICAgICBhZGRTdWZmaXg6IHRydWUsXG4gICAgfSlcbiAgICAgIC5yZXBsYWNlKCdhYm91dCcsICcnKVxuICAgICAgLnJlcGxhY2UoJ2FsbW9zdCcsICcnKTtcbiAgfVxuXG4gIHByaXZhdGUgaXNOb3RWYWxpZE51bWJlcih1bml0OiBudW1iZXIpOiBib29sZWFuIHtcbiAgICByZXR1cm4gTnVtYmVyLmlzTmFOKHVuaXQpO1xuICB9XG5cbiAgcHJpdmF0ZSBpc1ZhbGlkSG91cnMoaG91cnM6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmJldHdlZW4oaG91cnMsIDAsIDI0KTtcbiAgfVxuXG4gIHByaXZhdGUgaXNWYWxpZE1pbnV0ZXMobWludXRlczogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuYmV0d2VlbihtaW51dGVzLCAwLCA2MCk7XG4gIH1cblxuICBwcml2YXRlIGlzVmFsaWRTZWNvbmRzKHNlY29uZHM6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmJldHdlZW4oc2Vjb25kcywgMCwgNjApO1xuICB9XG5cbiAgcHJpdmF0ZSBiZXR3ZWVuKHg6IG51bWJlciwgbWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHggPj0gbWluICYmIHggPD0gbWF4O1xuICB9XG5cbiAgZGlmZmVyZW5jZUluU2Vjb25kcyhkMTogRGF0ZSwgZDI6IERhdGUpOiBudW1iZXIge1xuICAgIHJldHVybiBkaWZmZXJlbmNlSW5TZWNvbmRzKGQxLCBkMik7XG4gIH1cbn1cbiJdfQ==